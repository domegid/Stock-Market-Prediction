setwd("F:/DA Project")
data = read.csv ("Data.csv",nrows=100000)
data[,1] = as.Date(data[,1])
summary(data)
dim(data)
head(data)
summary(is.na(data))
boxplot(data[,c('open','close','low','high','volume')])
for(x in c('open','close','low','high','volume')){
val = data[,x][data[,x] %in% boxplot.stats(data[,x])$out]
data[,x][data[,x] %in% val] = NA
}
boxplot(data[,c('open','close','low','high')])
boxplot(data[,c('open','close','low','high','volume')])
library(tidyr)
data=drop_na(data)
dim(data)
as.data.frame(colSums(is.na(data)))
install.packages("quantmod")
install.packages("ggplot2")
library(quantmod)
library(ggplot2)
data1 = subset(data, symbol == "TSCO")
ggplot(data1, aes(x = data1[,1], y = data1[,3])) + geom_line(color = "darkblue") + ggtitle("TSCO Open Price Series") + xlab("Date") + ylab("Open Price") + theme(plot.title = element_text(hjust = 0.5)) + scale_x_date(date_labels = "%b %y", date_breaks = "6 months")
ggplot(data, aes(x = data[,1], y = data[,6])) + geom_line(color = "darkblue") + ggtitle("Highest Price vs Date") + xlab("Date") + ylab("Highest Price") + theme(plot.title = element_text(hjust = 0.5)) + scale_x_date(date_labels = "%b %y", date_breaks = "6 months")
ggplot(data, aes(x = data[,2], y = data[,6])) + geom_line(color = "darkblue") + ggtitle("Highest Price vs Symbol") + xlab("Symbol") + ylab("Highest Price") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data, aes(x = data[,1])) +
geom_line(aes(y = open, color = "open")) + ggtitle("Prices series") +
geom_line(aes(y = close, color = "close")) + xlab("Date") + ylab("Price") +
theme(plot.title = element_text(hjust = 0.5), panel.border = element_blank()) +
scale_x_date(date_labels = "%b %y", date_breaks = "3 months") +
scale_colour_manual("Series", values=c("open"="gray40", "close"="firebrick4"))
ggplot(data1, aes(x = data1[,1])) +
geom_line(aes(y = open, color = "open")) + ggtitle("Prices series") +
geom_line(aes(y = close, color = "close")) + xlab("Date") + ylab("Price") +
theme(plot.title = element_text(hjust = 0.5), panel.border = element_blank()) +
scale_x_date(date_labels = "%b %y", date_breaks = "3 months") +
scale_colour_manual("Series", values=c("open"="gray40", "close"="firebrick4"))
plot(data1[,4], main = "Closing Prices")
index <- sample(1:nrow(data), size=0.2*nrow(data))
test <- data[index, ]
train <- data[-index, ]
install.packages('randomForest')
library(randomForest)
model <- randomForest(as.factor(class)~ +low+high+open+close+volume, train, importance=TRUE, ntree=100, mtry=4)
print(model)
attributes(model)
library(caret)
p2 = predict(model,test)
confusionMatrix(p2,as.factor(test$class))
